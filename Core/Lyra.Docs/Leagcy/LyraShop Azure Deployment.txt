-----------------------
Deploying Lyra Node app
-----------------------

* RDP to windows server

* Install .net core 2.1 SDK:
Latest 2.1.* version: https://dotnet.microsoft.com/download/dotnet-core/2.1 
//https://dotnet.microsoft.com/download/thank-you/dotnet-sdk-2.1.802-windows-x64-installer

* Install the node app (unzip to c:\lyranode); 

* Enable PowerShell scripts:
Set-ExecutionPolicy RemoteSigned

* Create PowerShell script named run_lyra_node.ps1:
cd c:\lyranode
dotnet lyranode.dll --networkid devnet1 --seed self --database mongodb -- connectionstring mongodb+srv://lyra:iTbuBxv59M24027507kuyt@cluster0-qfihj.azure.mongodb.net/test?retryWrites=true&w=majority
#dotnet lyranode.dll --networkid shopify_testnet --seed self

* Configure PowerShell Script to Run on startup:
- Launch gpedit.msc.
- Navigate to Computer Configuration, Windows Settings, Scripts (Startup/Shutdown). ...
- Double-click Startup in the details window and select the PowerShell scripts tab.
- Add the PowerShell script you want to execute and click OK.

-------------------------------------------------
Deploying Lyra Node API on ASP.NET Core / IIS
-------------------------------------------------

* Install IIS:
Manual: Host ASP.NET Core on Windows with IIS   
https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/iis/index?view=aspnetcore-2.2#iis-configuration

* Download and install .net core runtime for windows:
.NET Core 2.1 Runtime & Hosting Bundle for Windows (v2.1.12) -
Latest 2.1.* version: https://dotnet.microsoft.com/download/dotnet-core/2.1 
//https://dotnet.microsoft.com/download/thank-you/dotnet-runtime-2.1.12-windows-hosting-bundle-installer

* unzip the app (see deployment) to c:\intetpub\wwwroot\Lyra.Node.API folder

* Configure IIS - create website:
https://docs.microsoft.com/en-us/aspnet/core/tutorials/publish-to-iis?view=aspnetcore-2.2&tabs=visual-studio

* Install SSL certificate (see SSL.txt)

* Mark ssl cert Exportable when installing to Personal store

* restart Windows VM

* in Chrome go to http://localhost/api/getsyncheight

* point domain to VM's public IP via DNS A record setup:
https://node.lyra.live

* Test:
https://node.lyra.live/api/getsyncheight
https://node1.lyra.live/api/getsyncheight


------------------------------------------------
Deploying LyraShop app on ASP.NET FW / IIS
------------------------------------------------

* install IIS and ASP.NET
https://docs.microsoft.com/en-us/iis/application-frameworks/scenario-build-an-aspnet-website-on-iis/configure-an-asp-net-website-on-iis

* Configure web deploy (run the script on VM and open VM's firewall and set up DNS name):
https://github.com/aspnet/Tooling/blob/AspNetVMs/docs/create-asp-net-vm-with-webdeploy.md

* Create the website in IIS

* Publish LyraShop app:
https://github.com/aspnet/Tooling/blob/AspNetVMs/docs/publish-web-app-from-visual-studio.md

* Install SSL certificate (see instructions in SSL.txt)

* restart Windows VM

* point subdomain to VM's public IP via DNS A record setup:
node.lyra.live

* Test:
https://shopify.lyra.live

----------------------------
Deploying LyraTrade job app
----------------------------

* install .NET core:
https://dotnet.microsoft.com/download/thank-you/dotnet-runtime-2.1.12-windows-x64-asp.net-core-runtime-installer

* Install the lyratrade app (unzip to c:\lyratrade); 

* Enable PowerShell scripts:
Set-ExecutionPolicy RemoteSigned

* Create PowerShell script named run_lyratrade.ps1:
cd c:\lyratrade
dotnet lyratrade.dll

* Configure PowerShell Script to Run on startup:
- Launch gpedit.msc.
- Navigate to Computer Configuration, Windows Settings, Scripts (Startup/Shutdown). ...
- Double-click Startup in the details window and select the PowerShell scripts tab.
- Add the PowerShell script you want to execute and click OK.








 